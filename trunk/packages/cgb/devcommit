#!/bin/bash
# ----------------------------------------------------------------------
# $Id: devcommit,v 1.3 2004/05/03 16:42:13 sturm Exp $
# ----------------------------------------------------------------------
# Copyright (c) 1999 Andreas Dolzmann and Thomas Sturm
# ----------------------------------------------------------------------
# $Log: devcommit,v $
# Revision 1.3  2004/05/03 16:42:13  sturm
# Avoid absolute path in tar file.
#
# Revision 1.2  2004/05/03 16:35:59  sturm
# Switch from Solaris to Linux.
# Touching for CSL and deleting for PSL.
#
# Revision 1.1  1999/04/05 09:58:12  sturm
# Initial check-in. Derived from the corresponding redlog tools.
#
# ----------------------------------------------------------------------
umask 002
unset noclobber
export develop=/public/algebra/reduce/develop
export wwwbase=~reduce/public_html/develop
export wwwdest=$wwwbase/reduce/packages
echo "compressing old version"
pushd $wwwdest
tar cf - ./cgb | gzip > cgb.old.tar.gz
popd
echo "removing old version"
/bin/rm -R $wwwdest/cgb
echo "copying new version"
/bin/cp -RL $develop/cgb $wwwdest
echo "setting group"
chgrp -R reduce $wwwdest/cgb
echo "setting access rights"
chmod 775 $wwwdest/cgb
chmod 664 $wwwdest/cgb/*
echo "exporting"
pushd $wwwdest/cgb &> /dev/null
$develop/devred/wutil/linux/xport -sign
popd &> /dev/null
echo "done"
